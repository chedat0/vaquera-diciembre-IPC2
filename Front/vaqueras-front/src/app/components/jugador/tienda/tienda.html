<div class="tienda-container">
    <!-- Banner/Carrusel Principal -->
    <div class="banner-section" *ngIf="juegosBanner.length > 0">
        <div class="banner-carousel">
            <div class="banner-slide" *ngFor="let juego of juegosBanner; let i = index"
                [class.active]="i === indiceBannerActual">
                <div class="banner-content">
                    <div class="banner-info">
                        <h2>{{ juego.titulo }}</h2>
                        <p class="banner-desc">{{ juego.descripcion }}</p>
                        <div class="banner-stats">
                            <span class="rating">{{ obtenerEstrellas(juego.promedioCalificacion || 0) }} {{
                                juego.promedioCalificacion }}</span>
                            <span class="price">${{ juego.precio }}</span>
                        </div>
                        <button (click)="verDetalle(juego)" class="btn-banner">Ver Detalles</button>
                    </div>
                    <div class="banner-image">
                        <img [src]="juego.imagenUrl" [alt]="juego.titulo">
                    </div>
                </div>
            </div>

            <!-- Controles del carrusel -->
            <button class="banner-control prev" (click)="anteriorBanner()">‚Äπ</button>
            <button class="banner-control next" (click)="siguienteBanner()">‚Ä∫</button>

            <!-- Indicadores -->
            <div class="banner-indicators">
                <span *ngFor="let juego of juegosBanner; let i = index" [class.active]="i === indiceBannerActual"
                    (click)="irABanner(i)"></span>
            </div>
        </div>
    </div>

    <!-- Secci√≥n de Filtros -->
    <div class="filters-container">
        <h2>Explorar Juegos</h2>

        <div class="filters-grid">
            <!-- B√∫squeda -->
            <div class="filter-group full-width">
                <input type="text" [(ngModel)]="busqueda" (ngModelChange)="aplicarFiltros()"
                    placeholder="üîç Buscar por t√≠tulo o descripci√≥n..." class="search-input">
            </div>

            <!-- Categor√≠a -->
            <div class="filter-group">
                <label>Categor√≠a</label>
                <select [(ngModel)]="categoriaSeleccionada" (ngModelChange)="aplicarFiltros()">
                    <option value="">Todas las categor√≠as</option>
                    <option *ngFor="let cat of categorias" [value]="cat.nombre">{{ cat.nombre }}</option>
                </select>
            </div>

            <!-- Empresa -->
            <div class="filter-group">
                <label>Desarrollador</label>
                <select [(ngModel)]="empresaSeleccionada" (ngModelChange)="aplicarFiltros()">
                    <option value="">Todos los desarrolladores</option>
                    <option *ngFor="let emp of empresas" [value]="emp.nombre">{{ emp.nombre }}</option>
                </select>
            </div>

            <!-- Precio -->
            <div class="filter-group">
                <label>Precio M√°ximo: ${{ precioMax }}</label>
                <input type="range" [(ngModel)]="precioMax" (ngModelChange)="aplicarFiltros()" min="0" max="1000"
                    step="10" class="range-input">
            </div>

            <!-- Clasificaci√≥n -->
            <div class="filter-group">
                <label>Clasificaci√≥n</label>
                <select [(ngModel)]="clasificacionSeleccionada" (ngModelChange)="aplicarFiltros()">
                    <option value="">Todas</option>
                    <option value="E">E - Para todos</option>
                    <option value="T">T - Adolescentes</option>
                    <option value="M">M - Adultos</option>
                </select>
            </div>

            <!-- Ordenamiento -->
            <div class="filter-group">
                <label>Ordenar por</label>
                <select [(ngModel)]="ordenamiento" (ngModelChange)="aplicarFiltros()">
                    <option value="balance">Mejor Balance</option>
                    <option value="calificacion">Mejor Calificaci√≥n</option>
                    <option value="precio-asc">Precio: Menor a Mayor</option>
                    <option value="precio-desc">Precio: Mayor a Menor</option>
                </select>
            </div>

            <!-- Bot√≥n limpiar -->
            <div class="filter-group">
                <button (click)="limpiarFiltros()" class="btn-clear">üóëÔ∏è Limpiar Filtros</button>
            </div>
        </div>
    </div>

    <!-- Resultados -->
    <div class="results-section">
        <div class="results-header">
            <h3>{{ juegosFiltrados.length }} juegos encontrados</h3>
        </div>

        <!-- Loading -->
        <div class="loading" *ngIf="cargando">
            <div class="spinner"></div>
            <p>Cargando juegos...</p>
        </div>

        <!-- Grid de Juegos -->
        <div class="juegos-grid" *ngIf="!cargando">
            <div class="juego-card" *ngFor="let juego of juegosPaginados" (click)="verDetalle(juego)">
                <div class="juego-image">
                    <img [src]="juego.imagenPrincipal" [alt]="juego.titulo">
                    <div class="juego-clasificacion">{{ juego.clasificacionEdad }}</div>
                </div>

                <div class="juego-content">
                    <h4 class="juego-title">{{ juego.titulo }}</h4>
                    <p class="juego-empresa">{{ juego.nombreEmpresa }}</p>

                    <div class="juego-categorias">
                        <span *ngFor="let cat of juego.categorias" class="categoria-tag">{{ cat }}</span>
                    </div>

                    <div class="juego-rating">
                        <span class="stars">{{ obtenerEstrellas(juego.calificacionPromedio || 0) }}</span>
                        <span class="rating-value">{{ juego.calificacionPromedio.toFixed(1)}}</span>
                    </div>

                    <div class="juego-footer">
                        <div class="juego-price">${{ juego.precio.toFixed(2) }}</div>
                        <button (click)="irAComprar(juego)">
                            üí≥ Comprar ${{ juego.precio }}
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="empty-state" *ngIf="!cargando && juegosPaginados.length === 0">
            <div class="empty-icon">üéÆ</div>
            <h3>No se encontraron juegos</h3>
            <p>Intenta ajustar los filtros de b√∫squeda</p>
            <button (click)="limpiarFiltros()" class="btn-primary">Limpiar Filtros</button>
        </div>

        <!-- Paginaci√≥n -->
        <div class="pagination" *ngIf="totalPaginas > 1">
            <button (click)="cambiarPagina(paginaActual - 1)" [disabled]="paginaActual === 1" class="page-btn">
                ‚Äπ Anterior
            </button>

            <button *ngFor="let pagina of paginasArray" (click)="cambiarPagina(pagina)"
                [class.active]="pagina === paginaActual" class="page-number">
                {{ pagina }}
            </button>

            <button (click)="cambiarPagina(paginaActual + 1)" [disabled]="paginaActual === totalPaginas"
                class="page-btn">
                Siguiente ‚Ä∫
            </button>
        </div>
    </div>
</div>