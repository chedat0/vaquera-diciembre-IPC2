<div class="perfil-container">
    <!-- Header -->
    <div class="header">
        <h1>üë§ Mi Perfil</h1>
    </div>

    <!-- Mensajes -->
    <div *ngIf="error" class="alert alert-error">{{ error }}</div>
    <div *ngIf="exito" class="alert alert-success">{{ exito }}</div>

    <!-- Loading -->
    <div *ngIf="cargando" class="loading">
        Cargando perfil...
    </div>

    <!-- Perfil -->
    <div *ngIf="!cargando && perfil" class="perfil-content">

        <!-- Vista Normal -->
        <div *ngIf="!modoEdicion" class="perfil-card">

            <!-- Avatar -->
            <div class="avatar-section">
                <div class="avatar">
                    {{ perfil.nickname.charAt(0).toUpperCase() }}
                </div>
                <h2>{{ perfil.nickname }}</h2>
                <p class="rol-badge">Jugador</p>
            </div>

            <!-- Informaci√≥n -->
            <div class="info-section">
                <div class="info-item">
                    <div class="info-label">üìß Correo Electr√≥nico</div>
                    <div class="info-value">{{ perfil.correo }}</div>
                </div>

                <div class="info-item">
                    <div class="info-label">üéÇ Fecha de Nacimiento</div>
                    <div class="info-value">{{ formatearFecha(perfil.fechaNacimiento) }} ({{ calcularEdad() }} a√±os)
                    </div>
                </div>

                <div class="info-item" *ngIf="perfil.telefono">
                    <div class="info-label">üì± Tel√©fono</div>
                    <div class="info-value">{{ perfil.telefono }}</div>
                </div>

                <div class="info-item" *ngIf="perfil.pais">
                    <div class="info-label">üåé Pa√≠s</div>
                    <div class="info-value">{{ perfil.pais }}</div>
                </div>

                <div class="info-item">
                    <div class="info-label">üìö Biblioteca</div>
                    <div class="info-value">
                        <span *ngIf="perfil.bibliotecaPublica" class="badge badge-success">
                            ‚úì P√∫blica (visible para otros)
                        </span>
                        <span *ngIf="!perfil.bibliotecaPublica" class="badge badge-secondary">
                            üîí Privada
                        </span>
                    </div>
                </div>
            </div>

            <!-- Acciones -->
            <div class="acciones-section">
                <button class="btn btn-primary" (click)="activarModoEdicion()">
                    ‚úèÔ∏è Editar Perfil
                </button>
            </div>
        </div>

        <!-- Modo Edici√≥n -->
        <div *ngIf="modoEdicion" class="perfil-card edicion">
            <h2>‚úèÔ∏è Editar Perfil</h2>

            <form class="form-edicion">
                <div class="form-group">
                    <label>Nickname *</label>
                    <input type="text" class="form-control" [(ngModel)]="perfilEditado.nickname" name="nickname"
                        placeholder="Tu nombre de usuario" [disabled]="procesando" required />
                    <small class="form-hint">M√≠nimo 3 caracteres</small>
                </div>

                <div class="form-group">
                    <label>Tel√©fono</label>
                    <input type="tel" class="form-control" [(ngModel)]="perfilEditado.telefono" name="telefono"
                        placeholder="Ej: +502 1234-5678" [disabled]="procesando" />
                </div>

                <div class="form-group">
                    <label>Pa√≠s</label>
                    <input type="text" class="form-control" [(ngModel)]="perfilEditado.pais" name="pais"
                        placeholder="Ej: Guatemala" [disabled]="procesando" />
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" [(ngModel)]="perfilEditado.bibliotecaPublica" name="bibliotecaPublica"
                            [disabled]="procesando" />
                        Hacer mi biblioteca p√∫blica (otros usuarios pueden ver tus juegos)
                    </label>
                </div>

                <div class="info-box">
                    <p>‚ÑπÔ∏è <strong>Nota:</strong> El correo y la fecha de nacimiento no se pueden modificar.</p>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" (click)="cancelarEdicion()" [disabled]="procesando">
                        Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" (click)="guardarCambios()" [disabled]="procesando">
                        <span *ngIf="!procesando">üíæ Guardar Cambios</span>
                        <span *ngIf="procesando">‚è≥ Guardando...</span>
                    </button>
                </div>
            </form>
        </div>

        <!-- Informaci√≥n adicional -->
        <div class="info-adicional">
            <h3>üí° Acerca de tu Perfil</h3>
            <ul>
                <li><strong>Nickname:</strong> Es tu identificaci√≥n en la plataforma</li>
                <li><strong>Biblioteca P√∫blica:</strong> Permite que otros jugadores vean tu colecci√≥n</li>
                <li><strong>Privacidad:</strong> Tu correo nunca ser√° compartido con otros usuarios</li>
            </ul>
        </div>
    </div>
</div>