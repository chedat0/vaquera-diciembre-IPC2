<div class="perfil-container">
    <!-- Header -->
    <div class="header">
        <h1>ğŸ‘¤ Mi Perfil</h1>
    </div>

    <!-- Mensajes -->
    <div *ngIf="error" class="alert alert-error">{{ error }}</div>
    <div *ngIf="exito" class="alert alert-success">{{ exito }}</div>

    <!-- Loading -->
    <div *ngIf="cargando" class="loading">
        Cargando perfil...
    </div>

    <!-- Perfil -->
    <div *ngIf="!cargando && perfil" class="perfil-content">

        <!-- Vista Normal -->
        <div *ngIf="!modoEdicion" class="perfil-card">

            <!-- Avatar -->
            <div class="avatar-section">
                <div class="avatar">
                    {{ perfil.nickname.charAt(0).toUpperCase() }}
                </div>
                <h2>{{ perfil.nickname }}</h2>
                <p class="rol-badge">Jugador</p>
            </div>

            <!-- InformaciÃ³n -->
            <div class="info-section">
                <div class="info-item">
                    <div class="info-label">ğŸ“§ Correo ElectrÃ³nico</div>
                    <div class="info-value">{{ perfil.correo }}</div>
                </div>

                <div class="info-item">
                    <div class="info-label">ğŸ‚ Fecha de Nacimiento</div>
                    <div class="info-value">{{ formatearFecha(perfil.fechaNacimiento) }} ({{ calcularEdad() }} aÃ±os)
                    </div>
                </div>

                <div class="info-item" *ngIf="perfil.telefono">
                    <div class="info-label">ğŸ“± TelÃ©fono</div>
                    <div class="info-value">{{ perfil.telefono }}</div>
                </div>

                <div class="info-item" *ngIf="perfil.pais">
                    <div class="info-label">ğŸŒ PaÃ­s</div>
                    <div class="info-value">{{ perfil.pais }}</div>
                </div>

                <div class="info-item">
                    <div class="info-label">ğŸ“š Biblioteca</div>
                    <div class="info-value">
                        <span *ngIf="perfil.bibliotecaPublica" class="badge badge-success">
                            âœ“ PÃºblica (visible para otros)
                        </span>
                        <span *ngIf="!perfil.bibliotecaPublica" class="badge badge-secondary">
                            ğŸ”’ Privada
                        </span>
                    </div>
                </div>
            </div>

            <!-- Acciones -->
            <div class="acciones-section">
                <button class="btn btn-primary" (click)="activarModoEdicion()">
                    âœï¸ Editar Perfil
                </button>
            </div>
        </div>

        <!-- Modo EdiciÃ³n -->
        <div *ngIf="modoEdicion" class="perfil-card edicion">
            <h2>âœï¸ Editar Perfil</h2>

            <form class="form-edicion">
                <div class="form-group">
                    <label>Nickname *</label>
                    <input type="text" class="form-control" [(ngModel)]="perfilEditado.nickname" name="nickname"
                        placeholder="Tu nombre de usuario" [disabled]="procesando" required />
                    <small class="form-hint">MÃ­nimo 3 caracteres</small>
                </div>

                <div class="form-group">
                    <label>TelÃ©fono</label>
                    <input type="tel" class="form-control" [(ngModel)]="perfilEditado.telefono" name="telefono"
                        placeholder="Ej: +502 1234-5678" [disabled]="procesando" />
                </div>

                <div class="form-group">
                    <label>PaÃ­s</label>
                    <input type="text" class="form-control" [(ngModel)]="perfilEditado.pais" name="pais"
                        placeholder="Ej: Guatemala" [disabled]="procesando" />
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" [(ngModel)]="perfilEditado.bibliotecaPublica" name="bibliotecaPublica"
                            [disabled]="procesando" />
                        Hacer mi biblioteca pÃºblica (otros usuarios pueden ver tus juegos)
                    </label>
                </div>

                <div class="info-box">
                    <p>â„¹ï¸ <strong>Nota:</strong> El correo y la fecha de nacimiento no se pueden modificar.</p>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" (click)="cancelarEdicion()" [disabled]="procesando">
                        Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" (click)="guardarCambios()" [disabled]="procesando">
                        <span *ngIf="!procesando">ğŸ’¾ Guardar Cambios</span>
                        <span *ngIf="procesando">â³ Guardando...</span>
                    </button>
                </div>
            </form>
        </div>

        <!-- InformaciÃ³n adicional -->
        <div class="info-adicional">
            <h3>ğŸ’¡ Acerca de tu Perfil</h3>
            <ul>
                <li><strong>Nickname:</strong> Es tu identificaciÃ³n en la plataforma</li>
                <li><strong>Biblioteca PÃºblica:</strong> Permite que otros jugadores vean tu colecciÃ³n</li>
                <li><strong>Privacidad:</strong> Tu correo nunca serÃ¡ compartido con otros usuarios</li>
            </ul>
        </div>

        <div class="logout-section">
            <button class="btn btn-danger btn-logout" (click)="cerrarSesion()">
                ğŸšª Cerrar sesiÃ³n
            </button>
        </div>
    </div>
</div>